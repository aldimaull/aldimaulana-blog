---
import Layout from "../../layouts/MainLayout.astro";
import Navbar from "../../components/Navbar.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import Card from "../../components/Card.astro";
import Pagination from "../../components/Pagination.astro";
import CategoryCloud from "../../components/CategoryCloud.astro";

import { formatBlogPosts } from "../../js/utils.js";

export async function getStaticPaths({ paginate }) {
 const allPosts = await Astro.glob("./*.{md,mdx}");
 const formattedPosts = formatBlogPosts(allPosts);

 return paginate(formattedPosts, { pageSize: 4 });
}

const { page } = Astro.props;
console.log(page);
---

<Layout title="Blog" description="Blog Page">
 <div class="dark:bg-neutral-10 bg-neutral-98 h-full md:flex">
  <div>
   <Navbar />
  </div>
  <div class="w-full mx-auto">
   <Header title="My Post" coverPhoto="/blog-cover.png" />
   <CategoryCloud showCount={true} />
   <div
    class="grid md:grid-cols-2 gap-2 items-center nowrap content-start md:max-w-4xl mx-auto mt-2 mb-4 p-2"
   >
    {page.data.map((post) => <Card posts={post.frontmatter} url={post.url} />)}
   </div>
   <div class="flex justify-center space-y-2 mb-4">
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
   </div>
   <Footer />
  </div>
 </div>
</Layout>
